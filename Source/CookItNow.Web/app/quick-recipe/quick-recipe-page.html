<template>
	<require from="quick-recipe/components/quick-recipe-header"></require>
	<require from="quick-recipe/components/quick-recipe-step"></require>
	<require from="quick-recipe/components/quick-recipe-footer"></require>
	<require from="shared/components/measurable-ingredient"></require>
	<require from="shared/components/comments-form"></require>
	<require from="shared/value-converters/duration-format"></require>
	
	<div class="quick-recipe" class.bind="backgroundClass">
	    <header class="row">
			<quick-recipe-header containerless recipe.bind="recipe"></quick-recipe-header>
	    </header>
		
		<main class="row">
			<aside class="ingredients col left z-depth-2 ${isSidePanelHidden ? 'hidden' : ''}">
				<div class="border-box">
					<div class="content">
						<div class="title parallax-container valign-wrapper">
							<div class="center col s12">
								<h3 i18n="quickRecipe.ingredientsSideTitle">Ingredients</h3>
							</div>
							<div class="parallax" materialize="parallax">
								<img src="app/quick-recipe/assets/images/pouding.jpg" alt.bind="recipe.title">
							</div>
						</div>
						
						<section repeat.for="subrecipe of subrecipeIngredients" class="section">
							<h4 if.bind="subrecipe.subrecipeTitle" class="center">${subrecipe.subrecipeTitle}</h4>
							<ul class="ingredient-list collection">
								<li repeat.for="ingredient of subrecipe.ingredients" class="collection-item ingredient-item">
									<measurable-ingredient containerless ingredient.bind="ingredient"></measurable-ingredient>
									<small if.bind="ingredient.replacements" repeat.for="replacement of ingredient.replacements">
										<div i18n="quickRecipe.ingredientReplacementConjunction">Or</div>
										<measurable-ingredient containerless ingredient.bind="replacement"></measurable-ingredient>
									</small>
								</li>
							</ul>
						</section>
					</div>
				</div>
			</aside>
			
			<div class="main section col right">
                <div class="content">
                    <section id="presentation-section" if.bind="!isRecipeStarted">
                        <div>
                            <h3>${recipe.title}</h3>
                            <div class="row">
                                <div>
                                    <span i18n="quickRecipe.servings">Servings</span>${recipe.originalServings}
                                </div>
                            </div>
                            
                            <div class="row">
                                <ul>
                                    <li repeat.for="duration of recipe.durations">
                                        ${duration.title}: ${duration.time | durationFormat}
                                    </li>
                                </ul>
                            </div>
                            
                            <div class="row center">
                                <a class="btn btn-large btn-success waves-effect waves-light" click.trigger="startRecipe()" i18n="quickRecipe.start">Start</a>
                            </div>
                        </div>
                    </section>
                    
                    <section id="recipe-content" show.bind="isRecipeStarted && !isRecipeDone">
                        <nav class="navbar z-depth-1">
                            <ul class="subrecipe-titles">
                                <li repeat.for="subrecipe of recipe.subrecipes" class="subrecipe-title ${$parent.activeSubrecipeId === subrecipe.id ? 'active' : ''}">
                                    ${subrecipe.title}
                                </li>
                            </ul>
                        </nav>
                        
                        <quick-recipe-step repeat.for="step of recipe.steps" id="step-${$index}" step.bind="step" class="step"></quick-recipe-step>
                            
                        <span class="step-actions">
                            <a class="complete-button waves-light btn" click.delegate="toggleSidePanelVisibility()">
								<span>Hide left panel</span>
                                <i class="material-icons left">toggle</i>
                            </a>
                            <a class="complete-button waves-light btn" click.delegate="goToCurrentStep()">
                                <i class="material-icons left">present_to_all</i>
                            </a>
                            <a class="complete-button waves-light btn" click.delegate="completeStep()">
                                <span if.bind="isLastStep" i18n="quickRecipe.finish">Finish</span>
                                <i if.bind="!isLastStep" class="material-icons right">done</i>
                            </a>
                        </span>
                    </section>
                    
                    <section id="comments-section" if.bind="isRecipeStarted && isRecipeDone">
                        <div class="row center">
                            <hgroup>
                                <h3 i18n="quickRecipe.comments.didYouLikeExperience">DidYouLikeExperience</h3>
                                <h4 i18n="quickRecipe.comments.wedLikeYourComments">WeLikeToHear</h4>
                            </hgroup>
                            <p i18n="quickRecipe.comments.writeComments">WriteComments</p>
                        </div>
                            
                        <comments-form containerless></comments-form>
                    </section>
                </div>
			</div>
		</main>
				
		<footer class="row page-footer fixed">
			<quick-recipe-footer containerless url.bind="recipe.originalUrl"></quick-recipe-footer>
		</footer>
	</div>
</template>
